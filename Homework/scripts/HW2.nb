(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     12671,        366]
NotebookOptionsPosition[     10549,        322]
NotebookOutlinePosition[     10883,        337]
CellTagsIndexPosition[     10840,        334]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[BoxData[{
 RowBox[{"m", " ", "=", " ", "1"}], "\[IndentingNewLine]", 
 RowBox[{"g", " ", "=", " ", "9.8"}], "\[IndentingNewLine]", 
 RowBox[{" ", 
  RowBox[{"M", " ", "=", " ", "10"}]}], "\[IndentingNewLine]", 
 RowBox[{"L", " ", "=", "0.3"}]}], "Input",
 CellChangeTimes->{{3.759002318738673*^9, 3.759002351184239*^9}, 
   3.759002446725164*^9, {3.759002720789112*^9, 3.759002775498234*^9}, {
   3.759002950393368*^9, 3.759002950613388*^9}},
 CellLabel->"In[22]:=",ExpressionUUID->"38750c0f-8ac3-45e2-a741-fb432fdaebb7"],

Cell[BoxData["1"], "Output",
 CellChangeTimes->{3.759002952638268*^9},
 CellLabel->"Out[22]=",ExpressionUUID->"3eeb5fde-f332-480e-980a-8394b10e1199"],

Cell[BoxData["9.8`"], "Output",
 CellChangeTimes->{3.7590029526398706`*^9},
 CellLabel->"Out[23]=",ExpressionUUID->"892ee912-0902-4d8c-b01c-eb778401c1a0"],

Cell[BoxData["10"], "Output",
 CellChangeTimes->{3.759002952641438*^9},
 CellLabel->"Out[24]=",ExpressionUUID->"eb156893-e893-4339-8598-e502a5689bc6"],

Cell[BoxData["0.3`"], "Output",
 CellChangeTimes->{3.759002952642996*^9},
 CellLabel->"Out[25]=",ExpressionUUID->"54d94b1a-73e1-44a9-af7d-286d88094700"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"A", " ", "=", " ", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"0", ",", "0", ",", "1", ",", "0"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"0", ",", "0", ",", "0", ",", "1"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"g", "/", "L"}], " ", "+", " ", 
       RowBox[{"m", "*", 
        RowBox[{
         RowBox[{"g", "/", "M"}], "/", "L"}]}]}], ",", "0", ",", "0", ",", 
      "0"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"m", "*", 
       RowBox[{"g", "/", "M"}]}], ",", "0", ",", "0", ",", "0"}], "}"}]}], 
   "}"}]}]], "Input",
 CellChangeTimes->{{3.7590023719457817`*^9, 3.7590023794782333`*^9}, {
  3.759002418289967*^9, 3.759002441813571*^9}, {3.759002486071624*^9, 
  3.759002538473136*^9}},
 CellLabel->"In[26]:=",ExpressionUUID->"26564ee4-8035-4869-a6dd-a445a96e660b"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "1", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"35.93333333333334`", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
   
   RowBox[{"{", 
    RowBox[{"0.9800000000000001`", ",", "0", ",", "0", ",", "0"}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{3.759002955381871*^9},
 CellLabel->"Out[26]=",ExpressionUUID->"b3c504ea-782c-4bb0-8f99-41e3729b8539"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"MatrixForm", "[", "A", "]"}]], "Input",
 NumberMarks->False,
 CellLabel->"In[27]:=",ExpressionUUID->"be2f4397-4240-4301-8b22-e2442775ac96"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "0", "1", "0"},
     {"0", "0", "0", "1"},
     {"35.93333333333334`", "0", "0", "0"},
     {"0.9800000000000001`", "0", "0", "0"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.759002957559689*^9},
 CellLabel->
  "Out[27]//MatrixForm=",ExpressionUUID->"eed01138-4f8a-40a5-9e40-\
4618704571f3"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Q", " ", "=", " ", 
  RowBox[{"DiagonalMatrix", "[", 
   RowBox[{"{", 
    RowBox[{"1", ",", "1", ",", "1", ",", "1"}], "}"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.759002559979664*^9, 3.7590026151603813`*^9}},
 CellLabel->"In[28]:=",ExpressionUUID->"96bd575a-6aea-4fac-907a-0b3913c44778"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"1", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "1", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "1", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "1"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.7590029596057253`*^9},
 CellLabel->"Out[28]=",ExpressionUUID->"4ff6c60e-be44-4700-bec3-7ee229c41b1d"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{"P", " ", "=", " ", 
   RowBox[{"LyapunovSolve", "[", 
    RowBox[{"A", ",", 
     RowBox[{"-", "Q"}]}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.759002637573954*^9, 3.759002669571138*^9}, 
   3.75900270102494*^9},
 CellLabel->"In[29]:=",ExpressionUUID->"677d30cb-f764-4c18-ae94-d2c82e734f2e"],

Cell[BoxData[
 TemplateBox[{
  "LyapunovSolve","nuniq","\"The matrix equation has no unique solution.\"",2,
   29,4,27141098553062600926,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.759002961576643*^9},
 CellLabel->
  "During evaluation of \
In[29]:=",ExpressionUUID->"c1194215-d833-4d57-9858-45839c5907fd"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"LyapunovSolve", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "1", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0", ",", "1"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"35.93333333333334`", ",", "0", ",", "0", ",", "0"}], "}"}], 
      ",", 
      RowBox[{"{", 
       RowBox[{"0.9800000000000001`", ",", "0", ",", "0", ",", "0"}], "}"}]}],
      "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "1"}], ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", 
        RowBox[{"-", "1"}], ",", "0", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", 
        RowBox[{"-", "1"}], ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0", ",", 
        RowBox[{"-", "1"}]}], "}"}]}], "}"}]}], "]"}], "\[IndentingNewLine]"}]
  ], "Input",
 CellChangeTimes->{{3.759113176109103*^9, 
  3.7591131799026327`*^9}},ExpressionUUID->"eeace867-0d02-4987-a5f2-\
fb26ed9fa05a"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Anew", " ", "=", " ", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"-", "k1"}], ",", "0", ",", "1", ",", "0"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"0", ",", 
      RowBox[{"-", "k2"}], ",", "0", ",", "0"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"g", "/", "L"}], " ", "+", " ", 
       RowBox[{"m", "*", 
        RowBox[{
         RowBox[{"g", "/", "M"}], "/", "L"}]}]}], ",", "0", ",", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "k3"}], "/", "L"}], "/", "M"}], ",", "0"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"m", "*", 
       RowBox[{"g", "/", "M"}]}], ",", "0", ",", "0", ",", 
      RowBox[{
       RowBox[{"-", "k4"}], "/", "M"}]}], "}"}]}], "}"}]}]], "Input",
 CellChangeTimes->{{3.7591132038384733`*^9, 3.759113316874648*^9}, {
  3.759113371611932*^9, 3.759113371789318*^9}},
 CellLabel->"In[3]:=",ExpressionUUID->"6622b356-716a-4182-899d-02059d08152f"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "k1"}], ",", "0", ",", "1", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", 
     RowBox[{"-", "k2"}], ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      FractionBox["g", "L"], "+", 
      FractionBox[
       RowBox[{"g", " ", "m"}], 
       RowBox[{"L", " ", "M"}]]}], ",", "0", ",", 
     RowBox[{"-", 
      FractionBox["k3", 
       RowBox[{"L", " ", "M"}]]}], ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     FractionBox[
      RowBox[{"g", " ", "m"}], "M"], ",", "0", ",", "0", ",", 
     RowBox[{"-", 
      FractionBox["k4", "M"]}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.7591133061532507`*^9, 3.759113317642275*^9}, 
   3.759113374011705*^9},
 CellLabel->"Out[3]=",ExpressionUUID->"e7453e38-798b-4735-a7a7-35a3d615eb8e"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Eigenvalues", "[", "Anew", "]"}]], "Input",
 CellChangeTimes->{{3.7591133772368593`*^9, 3.7591133863159027`*^9}},
 CellLabel->"In[4]:=",ExpressionUUID->"c39f7e18-d49d-4bb6-b8ea-893c9c3a00cd"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"-", 
    FractionBox["k4", "M"]}], ",", 
   RowBox[{"-", "k2"}], ",", 
   FractionBox[
    RowBox[{
     RowBox[{"-", "k3"}], "-", 
     RowBox[{"k1", " ", "L", " ", "M"}], "-", 
     SqrtBox[
      RowBox[{
       SuperscriptBox["k3", "2"], "-", 
       RowBox[{"2", " ", "k1", " ", "k3", " ", "L", " ", "M"}], "+", 
       RowBox[{"4", " ", "g", " ", "L", " ", "m", " ", "M"}], "+", 
       RowBox[{"4", " ", "g", " ", "L", " ", 
        SuperscriptBox["M", "2"]}], "+", 
       RowBox[{
        SuperscriptBox["k1", "2"], " ", 
        SuperscriptBox["L", "2"], " ", 
        SuperscriptBox["M", "2"]}]}]]}], 
    RowBox[{"2", " ", "L", " ", "M"}]], ",", 
   FractionBox[
    RowBox[{
     RowBox[{"-", "k3"}], "-", 
     RowBox[{"k1", " ", "L", " ", "M"}], "+", 
     SqrtBox[
      RowBox[{
       SuperscriptBox["k3", "2"], "-", 
       RowBox[{"2", " ", "k1", " ", "k3", " ", "L", " ", "M"}], "+", 
       RowBox[{"4", " ", "g", " ", "L", " ", "m", " ", "M"}], "+", 
       RowBox[{"4", " ", "g", " ", "L", " ", 
        SuperscriptBox["M", "2"]}], "+", 
       RowBox[{
        SuperscriptBox["k1", "2"], " ", 
        SuperscriptBox["L", "2"], " ", 
        SuperscriptBox["M", "2"]}]}]]}], 
    RowBox[{"2", " ", "L", " ", "M"}]]}], "}"}]], "Output",
 CellChangeTimes->{3.75911338727883*^9},
 CellLabel->"Out[4]=",ExpressionUUID->"4450f43e-9b64-4863-a66f-cc70135127f0"]
}, Open  ]]
},
WindowSize->{2782, 1764},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
FrontEndVersion->"11.3 for Linux x86 (64-bit) (March 6, 2018)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 526, 9, 105, "Input",ExpressionUUID->"38750c0f-8ac3-45e2-a741-fb432fdaebb7"],
Cell[1109, 33, 149, 2, 36, "Output",ExpressionUUID->"3eeb5fde-f332-480e-980a-8394b10e1199"],
Cell[1261, 37, 154, 2, 36, "Output",ExpressionUUID->"892ee912-0902-4d8c-b01c-eb778401c1a0"],
Cell[1418, 41, 150, 2, 36, "Output",ExpressionUUID->"eb156893-e893-4339-8598-e502a5689bc6"],
Cell[1571, 45, 152, 2, 36, "Output",ExpressionUUID->"54d94b1a-73e1-44a9-af7d-286d88094700"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1760, 52, 875, 24, 32, "Input",ExpressionUUID->"26564ee4-8035-4869-a6dd-a445a96e660b"],
Cell[2638, 78, 532, 14, 36, "Output",ExpressionUUID->"b3c504ea-782c-4bb0-8f99-41e3729b8539"]
}, Open  ]],
Cell[CellGroupData[{
Cell[3207, 97, 163, 3, 32, "Input",ExpressionUUID->"be2f4397-4240-4301-8b22-e2442775ac96"],
Cell[3373, 102, 832, 23, 107, "Output",ExpressionUUID->"eed01138-4f8a-40a5-9e40-4618704571f3"]
}, Open  ]],
Cell[CellGroupData[{
Cell[4242, 130, 316, 6, 32, "Input",ExpressionUUID->"96bd575a-6aea-4fac-907a-0b3913c44778"],
Cell[4561, 138, 492, 12, 36, "Output",ExpressionUUID->"4ff6c60e-be44-4700-bec3-7ee229c41b1d"]
}, Open  ]],
Cell[CellGroupData[{
Cell[5090, 155, 352, 8, 57, "Input",ExpressionUUID->"677d30cb-f764-4c18-ae94-d2c82e734f2e"],
Cell[5445, 165, 334, 8, 23, "Message",ExpressionUUID->"c1194215-d833-4d57-9858-45839c5907fd"]
}, Open  ]],
Cell[5794, 176, 1143, 33, 57, InheritFromParent,ExpressionUUID->"eeace867-0d02-4987-a5f2-fb26ed9fa05a"],
Cell[CellGroupData[{
Cell[6962, 213, 992, 28, 32, "Input",ExpressionUUID->"6622b356-716a-4182-899d-02059d08152f"],
Cell[7957, 243, 890, 27, 54, "Output",ExpressionUUID->"e7453e38-798b-4735-a7a7-35a3d615eb8e"]
}, Open  ]],
Cell[CellGroupData[{
Cell[8884, 275, 215, 3, 32, "Input",ExpressionUUID->"c39f7e18-d49d-4bb6-b8ea-893c9c3a00cd"],
Cell[9102, 280, 1431, 39, 99, "Output",ExpressionUUID->"4450f43e-9b64-4863-a66f-cc70135127f0"]
}, Open  ]]
}
]
*)

